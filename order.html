<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="./css.css">



  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
    integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
    crossorigin="anonymous" referrerpolicy="no-refe.rrer"></script>
  <link rel="stylesheet" href="./css.css">

  <title>ORDER</title>

</head>


<body>
  <div class="container mt-5">
    <div class="row">
      <div class="border-self">
        <h3> 甜品 | 飲品 </h3>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/1.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="美式鬆餅"
                data-price="100" data-img="1.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/2.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="巧克力豆餅乾"
                data-price="100" data-img="2.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/3.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="草莓淋醬甜甜圈"
                data-price="50" data-img="3.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/5.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="草莓蛋糕"
                data-price="80" data-img="5.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/6.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="巧克力雙重奏"
                data-price="50" data-img="6.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/7.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="櫻桃派"
                data-price="150" data-img="7.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/8.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="格子鬆餅"
                data-price="100" data-img="8.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/9c.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="藍莓重乳酪"
                data-price="80" data-img="9c.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/10.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="草莓珍珠拿鐵"
                data-price="90" data-img="10.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/11.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="黑糖珍珠鮮奶"
                data-price="60" data-img="11.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/12.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="抹茶珍珠拿鐵"
                data-price="80" data-img="12.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/14.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="日月潭紅茶 "
                data-price="100" data-img="14.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/15.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="美式咖啡"
                data-price="60" data-img="15.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/17.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="摩卡"
                data-price="100" data-img="17.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/19.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="卡布奇若"
                data-price="100" data-img="19.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>

      </div>
      <div class="col-sm-6 col-lg-3 mb-3">
        <div class="card" style="width: 18rem;">
          <img src="./img/21.png" class="card-img-top" alt="...">
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="itemBtn btn btn-outline-primary" type="button" id="item1Btn" data-stock-name="拿鐵"
                data-price="100" data-img="21.png">
                <!-- <i class="fas fa-cart-plus"></i> -->
              </button>
            </div>
          </div>
        </div>
      </div>



      <!-- 表格 -->
      <div class="container mt-5 border border-black" id="container-items">
        <div class="item-row row mt-5">
          <input type="hidden" class="imageName" value="">

          <div class="col">
            <div class="mb-3">
              <label class="form-label">商品</label>
              <input type="text" class="form-control stockName" value="" disabled>
            </div>
          </div>
          <div class="col">
            <div class="mb-3">
              <label class="form-label">單價</label>
              <input type="number" class="form-control priceName" disabled>
            </div>
          </div>
          <div class="col">
            <div class="mb-3">
              <label class="form-label">數量</label>
              <input type="number" class="form-control numInput">
            </div>
          </div>
          <div class="col">
            <div class="mb-3">
              <label class="form-label">金額</label>
              <input type="number" class="form-control sumInput" disabled>
            </div>
          </div>

          <div class="col">
            <label class="form-label">甜度</label>
            <select class="form-select sugerInput" name="iceInput">
              <option value="--" selected>--</option>
              <option value="少糖">少糖</option>
              <option value="正常">正常</option>
              <option value="半糖">半糖</option>
              <option value="微糖">微糖</option>
            </select>
          </div>
          <div class="col">

            <label for="" class="form-label">冰塊</label>
            <select class="form-select iceInput" name="iceInput">
              <option value="--" selected>--</option>
              <option value="去冰">去冰</option>
              <option value="少冰">少冰</option>
              <option value="正常">正常</option>
            </select>
          </div>
          <div class="col">
            <div class="mb-3">
              <label for="psInput" class="form-label">備註</label>
              <input type="text" class="form-control psInput">
            </div>
          </div>
          <div class="col">
            <div class="mb-3">
              <label class="form-label">操作</label>
              <div class="d-grid gap-2">
                <button class="btn btn-danger delBtnAll" type="button">
                  <i class="fa-solid fa-xmark"></i>&nbsp;&nbsp; 刪除</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container mt-5">
        <div class="row">
          <div class="col">
            <div class="d-grid gap-2">
              <button class="btn btn-success" type="button" id="checkBtn"><i class="fas fa-cart-plus"></i>
                &nbsp;&nbsp;確定新增</button>
            </div>
          </div>
        </div>

        <!-- 詳細內容 -->
        <div class="row mt-5">
          <div class="col">
            <hr>
            購買明細資料
            <div class="div p-5 border border-black" id="exDiv">
            </div>
          </div>
        </div>
      </div>




      <div>

      </div>
      <div>
        <br>
        <br>
      </div>
    </div>
  </div>
  </div>





  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
    integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>


  <script>

    $(document).ready(function () {
      const itemBtn = $('.itemBtn')
      const exDiv = $('#exDiv');
      const stockNameAll = $('.stockName');
      const nameInput = $('.nameInput');
      const priceInput = $('.priceName');
      const numInput = $('.numInput');
      const sumInput = $('.sumInput');
      const psInput = $('.psInput');
      const sugerInput = $('.sugerInput');
      const iceInput = $('.iceInput');
      const checkBtn = $('#checkBtn');
      const containerItems = $('#container-items');
      const delBtnAll = $('.delBtnAll');
      const orderBtn = $('#orderBtn');
      const exampleModal = $('#exampleModal');
      console.log('checkBtn', checkBtn);

      let myTotal = $('.sumInput');
      let bonus = $('#bonus');
      let bonusTotal = $('#bonusTotal');
      let modalResult = $('#modalResult');






      let i = 0;


      $.each(itemBtn, function (indexInArray, valueOfElement) {
        let stockName = $(this).attr('data-stock-name');
        let priceName = $(this).attr('data-price');
        let imageName = $(this).attr('data-img');
        console.log('itemBtn', itemBtn);

        $(valueOfElement).text(`${stockName}`);



      });


      delBtnAll.click(function () {
        if (!confirm("確定刪除?")) {
          return false;
        }





        let getLength = $('.item-row').length;


        if (getLength <= 1) {
          alert('不可以刪除');
          return false;
        }

        let nowDelBtn = $(this);
        let nowRow = nowDelBtn.parent().parent().parent().parent();

        nowRow.remove();

      });


      itemBtn.click(function () {
        let getRowStockName = $('.item-row').first().find('.stockName').val();
        let getPriceName = $('.item-row').first().find('.priceName').val();



        if (getRowStockName.length > 0) {

          $('.item-row').first().clone(true).appendTo('#container-items');
        }


        let lastRow = $('.item-row').last();
        let stockName = $(this).attr('data-stock-name');
        let priceName = $(this).attr('data-price');
        let imageName = $(this).attr('data-img');
        let sumInput = lastRow.find('.sumInput');
        let numInput = lastRow.find('.numInput');





        lastRow.find('.imageName').val(imageName);
        console.log('sumInput', sumInput);
        lastRow.find('.stockName').val(stockName);
        lastRow.find('.numInput').val('1');
        lastRow.find('.psInput').val('');
        lastRow.find('.sugerInput').val('--');
        lastRow.find('.iceInput').val('--');
        lastRow.find('.priceName').val(priceName);
        console.log('priceName', priceName);
        sumInput.val(priceName);
      });

      numInput.on('input', function () {
        let quantity = $(this).val();
        let priceName = $(this).closest('.item-row').find('.priceName').val();
        let sumInput = $(this).closest('.item-row').find('.sumInput');

        if (!isNaN(quantity) && !isNaN(priceName)) {
          let totalPrice = quantity * priceName;
          sumInput.val(totalPrice);
        } else {
          sumInput.val('');
        }
      });

      numInput.trigger('input');



      checkBtn.click(function () {

        i = 0;
        exDiv.html('');
        let total = 0;

        if (stockNameAll.first().val().length < 1) {
          alert('請選擇商品');
          return false;
        }

        let newStockNameAll = $('.stockName')
        $.each(newStockNameAll, function (indexInArray, valueOfElement) {

          i++;

          let closeRow = $(valueOfElement).parent().parent().parent();
          let name = closeRow.find('.stockName').val();
          let num = closeRow.find('.numInput').val();
          let ps = closeRow.find('.psInput').val();
          let suger = closeRow.find('.sugerInput').val();
          let ice = closeRow.find('.iceInput').val();
          let imageUrl = closeRow.find('.imageName').val();
          let sum = closeRow.find('.sumInput').val();
          total += parseFloat(sum);

          let content = `<p class="text-primary">  <img src="./img/${imageUrl}" width="100" height="100"> 第${i}項 商品  ${name} / x${num} / NT${sum} / ${suger} / ${ice}  / ${ps}</p>
        `;
          exDiv.append(content);




        });
        let totalContent = `<p>結帳金額: NT${total}</p>`;
        exDiv.append(totalContent);

      });


    });
  </script>

</body>

</html>